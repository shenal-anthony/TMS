-- -- This script was generated by the ERD tool in pgAdmin 4.
-- -- Please log an issue at https://github.com/pgadmin-org/pgadmin4/issues/new/choose if you find any bugs, including reproduction steps.
-- BEGIN;
-- -- Create the database if it doesn't already exist
-- -- CREATE DATABASE IF NOT EXISTS TMS_db;
-- -- USE TMS_db;
-- CREATE TABLE IF NOT EXISTS PUBLIC."accommodations" (
-- 	ACCOMMODATION_ID INTEGER NOT NULL,
-- 	ACCOMMODATION_NAME CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
-- 	LOCATION_URL TEXT COLLATE PG_CATALOG."default",
-- 	PICTURE_URL TEXT COLLATE PG_CATALOG."default",
-- 	CONTACT_NUMBER CHARACTER VARYING(15) COLLATE PG_CATALOG."default",
-- 	AMENITIES TEXT COLLATE PG_CATALOG."default",
-- 	UPDATED_AT TIMESTAMP WITHOUT TIME ZONE,
-- 	SERVICE_URL TEXT COLLATE PG_CATALOG."default",
-- 	ACCOMMODATION_TYPE CHARACTER VARYING(50) COLLATE PG_CATALOG."default",
-- 	CONSTRAINT "accommodations_pkey" PRIMARY KEY (ACCOMMODATION_ID)
-- );
-- CREATE TABLE IF NOT EXISTS PUBLIC."assignedGuides" (
-- 	USER_ID INTEGER NOT NULL,
-- 	BOOKING_ID INTEGER NOT NULL,
-- 	START_DATE DATE,
-- 	END_DATE DATE,
-- 	CONSTRAINT "assignedGuides_pkey" PRIMARY KEY (USER_ID, BOOKING_ID)
-- );
-- CREATE TABLE IF NOT EXISTS PUBLIC."assignedVehicles" (
-- 	VEHICLE_ID INTEGER NOT NULL,
-- 	BOOKING_ID INTEGER NOT NULL,
-- 	START_DATE DATE,
-- 	END_DATE DATE,
-- 	CONSTRAINT "assignedVehicles_pkey" PRIMARY KEY (VEHICLE_ID, BOOKING_ID)
-- );
-- CREATE TABLE IF NOT EXISTS PUBLIC."bookings" (
-- 	BOOKING_ID INTEGER NOT NULL,
-- 	BOOKING_DATE DATE,
-- 	HEADCOUNT INTEGER,
-- 	CHECK_IN_DATE DATE,
-- 	CHECK_OUT_DATE DATE,
-- 	STATUS CHARACTER VARYING(50) COLLATE PG_CATALOG."default",
-- 	TOURIST_ID INTEGER,
-- 	PAYMENT_ID INTEGER,
-- 	TOUR_ID INTEGER,
-- 	USER_ID INTEGER,
-- 	EVENT_ID INTEGER,
-- 	CONSTRAINT "bookings_pkey" PRIMARY KEY (BOOKING_ID)
-- );
-- CREATE TABLE IF NOT EXISTS PUBLIC."destinations" (
-- 	DESTINATION_ID INTEGER NOT NULL,
-- 	LOCATION_URL TEXT COLLATE PG_CATALOG."default",
-- 	PICTURE_URL TEXT COLLATE PG_CATALOG."default",
-- 	DESCRIPTION TEXT COLLATE PG_CATALOG."default",
-- 	DESTINATION_NAME CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
-- 	WEATHER_CONDITION CHARACTER VARYING(50) COLLATE PG_CATALOG."default",
-- 	CONSTRAINT "destinations_pkey" PRIMARY KEY (DESTINATION_ID)
-- );
-- CREATE TABLE IF NOT EXISTS PUBLIC."events" (
-- 	EVENT_ID INTEGER NOT NULL,
-- 	START_DATE DATE,
-- 	GROUP_SIZE INTEGER,
-- 	CONSTRAINT "events_pkey" PRIMARY KEY (EVENT_ID)
-- );
-- CREATE TABLE IF NOT EXISTS PUBLIC."feedbacks" (
-- 	ROLE CHARACTER VARYING(50) COLLATE PG_CATALOG."default" NOT NULL,
-- 	USER_ID INTEGER NOT NULL,
-- 	RATING INTEGER,
-- 	FEEDBACK_TEXT TEXT COLLATE PG_CATALOG."default",
-- 	TOURIST_ID INTEGER,
-- 	DATE_SUBMITTED DATE,
-- 	CONSTRAINT "feedbacks_pkey" PRIMARY KEY (ROLE, USER_ID)
-- );
-- CREATE TABLE IF NOT EXISTS PUBLIC."guides" (
-- 	USER_ID INTEGER NOT NULL,
-- 	ROLE CHARACTER VARYING(50) COLLATE PG_CATALOG."default",
-- 	TOURIST_LICENSE CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
-- 	CONSTRAINT "guides_pkey" PRIMARY KEY (USER_ID)
-- );
-- CREATE TABLE IF NOT EXISTS PUBLIC."packages" (
-- 	PACKAGE_ID INTEGER NOT NULL,
-- 	PACKAGE_NAME CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
-- 	DESCRIPTION TEXT COLLATE PG_CATALOG."default",
-- 	PRICE NUMERIC(10, 2),
-- 	DURATION INTEGER,
-- 	ACCOMMODATION_ID INTEGER,
-- 	DESTINATION_ID INTEGER,
-- 	CONSTRAINT "packages_pkey" PRIMARY KEY (PACKAGE_ID)
-- );
-- CREATE TABLE IF NOT EXISTS PUBLIC."packageAccommodations" (
-- 	ACCOMMODATION_ID INTEGER NOT NULL,
-- 	TOUR_ID INTEGER NOT NULL,
-- 	CONSTRAINT "packageAccommodations_pkey" PRIMARY KEY (ACCOMMODATION_ID, TOUR_ID)
-- );
-- CREATE TABLE IF NOT EXISTS PUBLIC."packageDestinations" (
-- 	DESTINATION_ID INTEGER NOT NULL,
-- 	TOUR_ID INTEGER NOT NULL,
-- 	CONSTRAINT "packageDestinations_pkey" PRIMARY KEY (DESTINATION_ID, TOUR_ID)
-- );
-- CREATE TABLE IF NOT EXISTS PUBLIC."payments" (
-- 	PAYMENT_ID INTEGER NOT NULL,
-- 	AMOUNT NUMERIC(10, 2),
-- 	PAYMENT_DATE DATE,
-- 	STATUS CHARACTER VARYING(50) COLLATE PG_CATALOG."default",
-- 	BOOKING_ID INTEGER,
-- 	CONSTRAINT "payments_pkey" PRIMARY KEY (PAYMENT_ID)
-- );
-- CREATE TABLE IF NOT EXISTS PUBLIC."reports" (
-- 	REPORT_ID INTEGER NOT NULL,
-- 	GENERATED_DATE DATE,
-- 	START_DATE DATE,
-- 	END_DATE DATE,
-- 	COMMENT TEXT COLLATE PG_CATALOG."default",
-- 	REPORT_DATA TEXT COLLATE PG_CATALOG."default",
-- 	REPORT_TYPE CHARACTER VARYING(50) COLLATE PG_CATALOG."default",
-- 	USER_ID INTEGER,
-- 	ROLE CHARACTER VARYING(50) COLLATE PG_CATALOG."default",
-- 	CONSTRAINT "reports_pkey" PRIMARY KEY (REPORT_ID)
-- );
-- CREATE TABLE IF NOT EXISTS PUBLIC."reviews" (
-- 	REVIEW_ID INTEGER NOT NULL,
-- 	RATING INTEGER,
-- 	REVIEW_TEXT TEXT COLLATE PG_CATALOG."default",
-- 	REVIEW_DATE DATE,
-- 	EVENT_ID INTEGER,
-- 	ACCOMMODATION_ID INTEGER,
-- 	TOUR_ID INTEGER,
-- 	STATUS CHARACTER VARYING(50) COLLATE PG_CATALOG."default",
-- 	TOURIST_ID INTEGER,
-- 	PACKAGE_ID INTEGER,
-- 	CONSTRAINT "reviews_pkey" PRIMARY KEY (REVIEW_ID)
-- );
-- CREATE TABLE IF NOT EXISTS PUBLIC."tours" (
-- 	TOUR_ID INTEGER NOT NULL,
-- 	ACTIVITY CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
-- 	PICTURE_URL TEXT COLLATE PG_CATALOG."default",
-- 	CONSTRAINT "tours_pkey" PRIMARY KEY (TOUR_ID)
-- );
-- CREATE TABLE IF NOT EXISTS PUBLIC."tourists" (
-- 	TOURIST_ID INTEGER NOT NULL,
-- 	FIRST_NAME CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
-- 	LAST_NAME CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
-- 	EMAIL_ADDRESS CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
-- 	CONTACT_NUMBER CHARACTER VARYING(15) COLLATE PG_CATALOG."default",
-- 	NIC_NUMBER CHARACTER VARYING(12) COLLATE PG_CATALOG."default",
-- 	COUNTRY CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
-- 	CITY CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
-- 	POSTAL_CODE CHARACTER VARYING(20) COLLATE PG_CATALOG."default",
-- 	ADDRESSLINE_01 CHARACTER VARYING(255) COLLATE PG_CATALOG."default",
-- 	ADDRESSLINE_02 CHARACTER VARYING(255) COLLATE PG_CATALOG."default",
-- 	CONSTRAINT "tourists_pkey" PRIMARY KEY (TOURIST_ID)
-- );
-- CREATE TABLE IF NOT EXISTS PUBLIC."users" (
-- 	USER_ID INTEGER NOT NULL,
-- 	FIRST_NAME CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
-- 	LAST_NAME CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
-- 	PROFILE_PICTURE TEXT COLLATE PG_CATALOG."default",
-- 	TOURIST_LICENSE TEXT COLLATE PG_CATALOG."default",
-- 	CONTACT_NUMBER CHARACTER VARYING(15) COLLATE PG_CATALOG."default",
-- 	EMAIL_ADDRESS CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
-- 	NIC_NUMBER CHARACTER VARYING(12) COLLATE PG_CATALOG."default",
-- 	PASSWORD CHARACTER VARYING(255) COLLATE PG_CATALOG."default",
-- 	ROLE CHARACTER VARYING(50) COLLATE PG_CATALOG."default",
-- 	STATUS CHARACTER VARYING(50) COLLATE PG_CATALOG."default",
-- 	ADDRESSLINE_01 CHARACTER VARYING(255) COLLATE PG_CATALOG."default",
-- 	ADDRESSLINE_02 CHARACTER VARYING(255) COLLATE PG_CATALOG."default",
-- 	CONSTRAINT "users_pkey" PRIMARY KEY (USER_ID)
-- );
-- CREATE TABLE IF NOT EXISTS PUBLIC."vehicles" (
-- 	VEHICLE_ID INTEGER NOT NULL,
-- 	PICTURE_URL TEXT COLLATE PG_CATALOG."default",
-- 	VEHICLE_TYPE CHARACTER VARYING(50) COLLATE PG_CATALOG."default",
-- 	BRAND CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
-- 	MODEL CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
-- 	AIR_CONDITION BOOLEAN,
-- 	COLOR CHARACTER VARYING(50) COLLATE PG_CATALOG."default",
-- 	NUMBER_PLATE CHARACTER VARYING(20) COLLATE PG_CATALOG."default",
-- 	FUEL_TYPE CHARACTER VARYING(50) COLLATE PG_CATALOG."default",
-- 	REGISTRATION_NUMBER CHARACTER VARYING(50) COLLATE PG_CATALOG."default",
-- 	USER_ID INTEGER,
-- 	CONSTRAINT "vehicles_pkey" PRIMARY KEY (VEHICLE_ID)
-- );
-- ALTER TABLE IF EXISTS PUBLIC."assignedGuides"
-- ADD CONSTRAINT "assignedGuides_booking_id_fkey" FOREIGN KEY (BOOKING_ID) REFERENCES PUBLIC."bookings" (BOOKING_ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
-- ALTER TABLE IF EXISTS PUBLIC."assignedGuides"
-- ADD CONSTRAINT "assignedGuides_user_id_fkey" FOREIGN KEY (USER_ID) REFERENCES PUBLIC."users" (USER_ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
-- ALTER TABLE IF EXISTS PUBLIC."assignedVehicles"
-- ADD CONSTRAINT "assignedVehicles_booking_id_fkey" FOREIGN KEY (BOOKING_ID) REFERENCES PUBLIC."bookings" (BOOKING_ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
-- ALTER TABLE IF EXISTS PUBLIC."assignedVehicles"
-- ADD CONSTRAINT "assignedVehicles_vehicle_id_fkey" FOREIGN KEY (VEHICLE_ID) REFERENCES PUBLIC."vehicles" (VEHICLE_ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
-- ALTER TABLE IF EXISTS PUBLIC."bookings"
-- ADD CONSTRAINT "bookings_event_id_fkey" FOREIGN KEY (EVENT_ID) REFERENCES PUBLIC."events" (EVENT_ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
-- ALTER TABLE IF EXISTS PUBLIC."bookings"
-- ADD CONSTRAINT "bookings_payment_id_fkey" FOREIGN KEY (PAYMENT_ID) REFERENCES PUBLIC."payments" (PAYMENT_ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
-- ALTER TABLE IF EXISTS PUBLIC."bookings"
-- ADD CONSTRAINT "bookings_tour_id_fkey" FOREIGN KEY (TOUR_ID) REFERENCES PUBLIC."tours" (TOUR_ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
-- ALTER TABLE IF EXISTS PUBLIC."bookings"
-- ADD CONSTRAINT "bookings_tourist_id_fkey" FOREIGN KEY (TOURIST_ID) REFERENCES PUBLIC."tourists" (TOURIST_ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
-- ALTER TABLE IF EXISTS PUBLIC."bookings"
-- ADD CONSTRAINT "bookings_user_id_fkey" FOREIGN KEY (USER_ID) REFERENCES PUBLIC."users" (USER_ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
-- ALTER TABLE IF EXISTS PUBLIC."feedbacks"
-- ADD CONSTRAINT "feedbacks_tourist_id_fkey" FOREIGN KEY (TOURIST_ID) REFERENCES PUBLIC."tourists" (TOURIST_ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
-- ALTER TABLE IF EXISTS PUBLIC."feedbacks"
-- ADD CONSTRAINT "feedbacks_user_id_fkey" FOREIGN KEY (USER_ID) REFERENCES PUBLIC."users" (USER_ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
-- ALTER TABLE IF EXISTS PUBLIC."guides"
-- ADD CONSTRAINT "guides_user_id_fkey" FOREIGN KEY (USER_ID) REFERENCES PUBLIC."users" (USER_ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
-- CREATE INDEX IF NOT EXISTS "guide_pkey" ON PUBLIC."guides" (USER_ID);
-- ALTER TABLE IF EXISTS PUBLIC."packages"
-- ADD CONSTRAINT "packages_accommodation_id_fkey" FOREIGN KEY (ACCOMMODATION_ID) REFERENCES PUBLIC."accommodations" (ACCOMMODATION_ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
-- ALTER TABLE IF EXISTS PUBLIC."packages"
-- ADD CONSTRAINT "packages_destination_id_fkey" FOREIGN KEY (DESTINATION_ID) REFERENCES PUBLIC."destinations" (DESTINATION_ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
-- ALTER TABLE IF EXISTS PUBLIC."packageAccommodations"
-- ADD CONSTRAINT "packageAccommodations_accommodation_id_fkey" FOREIGN KEY (ACCOMMODATION_ID) REFERENCES PUBLIC."accommodations" (ACCOMMODATION_ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
-- ALTER TABLE IF EXISTS PUBLIC."packageAccommodations"
-- ADD CONSTRAINT "packageAccommodations_tour_id_fkey" FOREIGN KEY (TOUR_ID) REFERENCES PUBLIC."tours" (TOUR_ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
-- ALTER TABLE IF EXISTS PUBLIC."packageDestinations"
-- ADD CONSTRAINT "packageDestinations_destination_id_fkey" FOREIGN KEY (DESTINATION_ID) REFERENCES PUBLIC."destinations" (DESTINATION_ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
-- ALTER TABLE IF EXISTS PUBLIC."packageDestinations"
-- ADD CONSTRAINT "packageDestinations_tour_id_fkey" FOREIGN KEY (TOUR_ID) REFERENCES PUBLIC."tours" (TOUR_ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
-- ALTER TABLE IF EXISTS PUBLIC."reports"
-- ADD CONSTRAINT "reports_user_id_fkey" FOREIGN KEY (USER_ID) REFERENCES PUBLIC."users" (USER_ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
-- ALTER TABLE IF EXISTS PUBLIC."reviews"
-- ADD CONSTRAINT "reviews_accommodation_id_fkey" FOREIGN KEY (ACCOMMODATION_ID) REFERENCES PUBLIC."accommodations" (ACCOMMODATION_ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
-- ALTER TABLE IF EXISTS PUBLIC."reviews"
-- ADD CONSTRAINT "reviews_package_id_fkey" FOREIGN KEY (PACKAGE_ID) REFERENCES PUBLIC."packages" (PACKAGE_ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
-- ALTER TABLE IF EXISTS PUBLIC."reviews"
-- ADD CONSTRAINT "reviews_event_id_fkey" FOREIGN KEY (EVENT_ID) REFERENCES PUBLIC."events" (EVENT_ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
-- ALTER TABLE IF EXISTS PUBLIC."reviews"
-- ADD CONSTRAINT "reviews_tour_id_fkey" FOREIGN KEY (TOUR_ID) REFERENCES PUBLIC."tours" (TOUR_ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
-- ALTER TABLE IF EXISTS PUBLIC."reviews"
-- ADD CONSTRAINT "reviews_tourist_id_fkey" FOREIGN KEY (TOURIST_ID) REFERENCES PUBLIC."tourists" (TOURIST_ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
-- ALTER TABLE IF EXISTS PUBLIC."vehicles"
-- ADD CONSTRAINT "vehicles_user_id_fkey" FOREIGN KEY (USER_ID) REFERENCES PUBLIC."users" (USER_ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
-- END;
CREATE TABLE IF NOT EXISTS PUBLIC."users" (
	USER_ID SERIAL PRIMARY KEY,
	FIRST_NAME CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
	LAST_NAME CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
	PROFILE_PICTURE TEXT COLLATE PG_CATALOG."default",
	TOURIST_LICENSE TEXT COLLATE PG_CATALOG."default",
	CONTACT_NUMBER CHARACTER VARYING(15) COLLATE PG_CATALOG."default",
	EMAIL_ADDRESS CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
	NIC_NUMBER CHARACTER VARYING(12) COLLATE PG_CATALOG."default",
	PASSWORD CHARACTER VARYING(255) COLLATE PG_CATALOG."default",
	ROLE CHARACTER VARYING(50) COLLATE PG_CATALOG."default",
	STATUS CHARACTER VARYING(50) COLLATE PG_CATALOG."default",
	ADDRESSLINE_01 CHARACTER VARYING(255) COLLATE PG_CATALOG."default",
	ADDRESSLINE_02 CHARACTER VARYING(255) COLLATE PG_CATALOG."default"
);
CREATE TABLE IF NOT EXISTS PUBLIC."vehicles" (
	VEHICLE_ID SERIAL PRIMARY KEY,
	VEHICLE_PICTURE TEXT COLLATE PG_CATALOG."default",
	TOURIST_LICENSE TEXT COLLATE PG_CATALOG."default",
	VEHICLE_TYPE CHARACTER VARYING(50) COLLATE PG_CATALOG."default",
	BRAND CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
	MODEL CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
	AIR_CONDITION BOOLEAN,
	COLOR CHARACTER VARYING(50) COLLATE PG_CATALOG."default",
	NUMBER_PLATE CHARACTER VARYING(20) COLLATE PG_CATALOG."default",
	FUEL_TYPE CHARACTER VARYING(50) COLLATE PG_CATALOG."default",
	REGISTRATION_NUMBER CHARACTER VARYING(50) COLLATE PG_CATALOG."default",
	STATUS CHARACTER VARYING(50) COLLATE PG_CATALOG."default",
	USER_ID INTEGER NOT NULL,
	CONSTRAINT "fk_vehicles_users" FOREIGN KEY (USER_ID) REFERENCES PUBLIC."users" (USER_ID) ON DELETE
	SET NULL
);

CREATE TABLE IF NOT EXISTS PUBLIC."guide_responses" (
  MSG_ID SERIAL PRIMARY KEY,
  GUIDE_ID INTEGER NOT NULL,
  BOOKING_ID INTEGER NOT NULL,
  STATUS BOOLEAN NOT NULL,
  SENT_AT TIMESTAMPTZ,
  UPDATED_AT TIMESTAMPTZ,
  UNIQUE (guide_id, booking_id)
);


-- ALTER TABLE IF EXISTS PUBLIC."vehicles"
-- ADD COLUMN STATUS CHARACTER VARYING(50) COLLATE PG_CATALOG."default";


CREATE TABLE IF NOT EXISTS PUBLIC."accommodations" (
	ACCOMMODATION_ID SERIAL PRIMARY KEY,
	ACCOMMODATION_NAME CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
	LOCATION_URL TEXT COLLATE PG_CATALOG."default",
	PICTURE_URL TEXT COLLATE PG_CATALOG."default",
	CONTACT_NUMBER CHARACTER VARYING(15) COLLATE PG_CATALOG."default",
	AMENITIES TEXT COLLATE PG_CATALOG."default",
	UPDATED_AT TIMESTAMP WITHOUT TIME ZONE,
	SERVICE_URL TEXT COLLATE PG_CATALOG."default",
	ACCOMMODATION_TYPE CHARACTER VARYING(50) COLLATE PG_CATALOG."default"
);
CREATE TABLE IF NOT EXISTS PUBLIC."assigned_guides" (
	USER_ID INTEGER NOT NULL,
	BOOKING_ID INTEGER NOT NULL,
	START_DATE DATE,
	END_DATE DATE,
	CONSTRAINT "assignedGuides_pkey" PRIMARY KEY (USER_ID, BOOKING_ID),
	CONSTRAINT "fk_assignedGuides_users" FOREIGN KEY (USER_ID) REFERENCES PUBLIC."users" (USER_ID) ON DELETE CASCADE,
	CONSTRAINT "fk_assignedGuides_bookings" FOREIGN KEY (BOOKING_ID) REFERENCES PUBLIC."bookings" (BOOKING_ID) ON DELETE CASCADE
);
CREATE TABLE IF NOT EXISTS PUBLIC."assigned_vehicles" (
	VEHICLE_ID INTEGER NOT NULL,
	BOOKING_ID INTEGER NOT NULL,
	START_DATE DATE,
	END_DATE DATE,
	CONSTRAINT "assignedVehicles_pkey" PRIMARY KEY (VEHICLE_ID, BOOKING_ID),
	CONSTRAINT "fk_assignedVehicles_vehicles" FOREIGN KEY (VEHICLE_ID) REFERENCES PUBLIC."vehicles" (VEHICLE_ID) ON DELETE CASCADE,
	CONSTRAINT "fk_assignedVehicles_bookings" FOREIGN KEY (BOOKING_ID) REFERENCES PUBLIC."bookings" (BOOKING_ID) ON DELETE CASCADE
);
CREATE TABLE IF NOT EXISTS PUBLIC."bookings" (
	BOOKING_ID SERIAL PRIMARY KEY,
	BOOKING_DATE DATE,
	HEADCOUNT INTEGER,
	CHECK_IN_DATE DATE,
	CHECK_OUT_DATE DATE,
	STATUS CHARACTER VARYING(50) COLLATE PG_CATALOG."default",
	TOURIST_ID INTEGER NOT NULL,
	TOUR_ID INTEGER NOT NULL,
	USER_ID INTEGER NOT NULL,
	EVENT_ID INTEGER NOT NULL,
	CONSTRAINT "fk_bookings_tourists" FOREIGN KEY (TOURIST_ID) REFERENCES PUBLIC."tourists" (TOURIST_ID) ON DELETE
	SET NULL,
		CONSTRAINT "fk_bookings_tours" FOREIGN KEY (TOUR_ID) REFERENCES PUBLIC."tours" (TOUR_ID) ON DELETE
	SET NULL,
		CONSTRAINT "fk_bookings_users" FOREIGN KEY (USER_ID) REFERENCES PUBLIC."users" (USER_ID) ON DELETE
	SET NULL,
		CONSTRAINT "fk_bookings_events" FOREIGN KEY (EVENT_ID) REFERENCES PUBLIC."events" (EVENT_ID) ON DELETE
	SET NULL
);
CREATE TABLE IF NOT EXISTS PUBLIC."destinations" (
	DESTINATION_ID SERIAL PRIMARY KEY,
	LOCATION_URL TEXT COLLATE PG_CATALOG."default",
	PICTURE_URL TEXT COLLATE PG_CATALOG."default",
	DESCRIPTION TEXT COLLATE PG_CATALOG."default",
	DESTINATION_NAME CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
	WEATHER_CONDITION CHARACTER VARYING(50) COLLATE PG_CATALOG."default"
);
CREATE TABLE IF NOT EXISTS PUBLIC."events" (
	EVENT_ID SERIAL PRIMARY KEY,
	START_DATE DATE,
	GROUP_SIZE INTEGER,
	DESCRIPTION TEXT COLLATE PG_CATALOG."default"
);
CREATE TABLE IF NOT EXISTS PUBLIC."feedbacks" (
	TOURIST_ID INTEGER NOT NULL,
	RATING INTEGER,
	FEEDBACK_TEXT TEXT COLLATE PG_CATALOG."default",
	DATE_SUBMITTED DATE,
	CONSTRAINT "feedbacks_pkey" PRIMARY KEY (TOURIST_ID),
	CONSTRAINT "fk_feedbacks_tourists" FOREIGN KEY (TOURIST_ID) REFERENCES PUBLIC."tourists" (TOURIST_ID) ON DELETE
	SET NULL
);
-- CREATE TABLE IF NOT EXISTS PUBLIC."guides" (
-- 	USER_ID INTEGER NOT NULL,
-- 	ROLE CHARACTER VARYING(50) NOT NULL,
-- 	TOURIST_LICENSE CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
-- 	CONSTRAINT "guides_pkey" PRIMARY KEY (USER_ID, ROLE),
-- 	CONSTRAINT "fk_guides_users" FOREIGN KEY (USER_ID) REFERENCES PUBLIC."users" (USER_ID) ON DELETE CASCADE,
-- 	CONSTRAINT "fk_guides_role" FOREIGN KEY (ROLE) REFERENCES PUBLIC."users" (ROLE) ON DELETE CASCADE
-- );
CREATE TABLE IF NOT EXISTS PUBLIC."packages" (
	PACKAGE_ID SERIAL PRIMARY KEY,
	PACKAGE_NAME CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
	DESCRIPTION TEXT COLLATE PG_CATALOG."default",
	PRICE NUMERIC(10, 2),
	DURATION INTEGER,
	ACCOMMODATION_ID INTEGER NOT NULL,
	DESTINATION_ID INTEGER NOT NULL,
	CONSTRAINT "fk_packages_accommodations" FOREIGN KEY (ACCOMMODATION_ID) REFERENCES PUBLIC."accommodations" (ACCOMMODATION_ID) ON DELETE
	SET NULL,
		CONSTRAINT "fk_packages_destinations" FOREIGN KEY (DESTINATION_ID) REFERENCES PUBLIC."destinations" (DESTINATION_ID) ON DELETE
	SET NULL
);
CREATE TABLE IF NOT EXISTS PUBLIC."packageAccommodations" (
	ACCOMMODATION_ID INTEGER NOT NULL,
	TOUR_ID INTEGER NOT NULL,
	CONSTRAINT "packageAccommodations_pkey" PRIMARY KEY (ACCOMMODATION_ID, TOUR_ID),
	CONSTRAINT "fk_packageAccommodations_accommodations" FOREIGN KEY (ACCOMMODATION_ID) REFERENCES PUBLIC."accommodations" (ACCOMMODATION_ID) ON DELETE CASCADE,
	CONSTRAINT "fk_packageAccommodations_tours" FOREIGN KEY (TOUR_ID) REFERENCES PUBLIC."tours" (TOUR_ID) ON DELETE CASCADE
);
CREATE TABLE IF NOT EXISTS PUBLIC."packageDestinations" (
	DESTINATION_ID INTEGER NOT NULL,
	TOUR_ID INTEGER NOT NULL,
	CONSTRAINT "packageDestinations_pkey" PRIMARY KEY (DESTINATION_ID, TOUR_ID),
	CONSTRAINT "fk_packageDestinations_destinations" FOREIGN KEY (DESTINATION_ID) REFERENCES PUBLIC."destinations" (DESTINATION_ID) ON DELETE CASCADE,
	CONSTRAINT "fk_packageDestinations_tours" FOREIGN KEY (TOUR_ID) REFERENCES PUBLIC."tours" (TOUR_ID) ON DELETE CASCADE
);
CREATE TABLE IF NOT EXISTS PUBLIC."payments" (
	PAYMENT_ID SERIAL PRIMARY KEY,
	AMOUNT NUMERIC(10, 2),
	PAYMENT_DATE DATE,
	FINALIZED_DATE DATE,
	STATUS CHARACTER VARYING(50) COLLATE PG_CATALOG."default",
	BOOKING_ID INTEGER NOT NULL,
	CONSTRAINT "fk_payments_bookings" FOREIGN KEY (BOOKING_ID) REFERENCES PUBLIC."bookings" (BOOKING_ID) ON DELETE
	SET NULL
);
-- ALTER TABLE PUBLIC."payments"
-- ADD COLUMN FINALIZED_DATE DATE;

-- ALTER TABLE PUBLIC."payments"
-- DROP COLUMN FINALIZED_DATE;

CREATE TABLE IF NOT EXISTS PUBLIC."reports" (
	REPORT_ID SERIAL PRIMARY KEY,
	GENERATED_DATE DATE,
	START_DATE DATE,
	END_DATE DATE,
	COMMENT TEXT COLLATE PG_CATALOG."default",
	REPORT_DATA TEXT COLLATE PG_CATALOG."default",
	REPORT_TYPE CHARACTER VARYING(50) COLLATE PG_CATALOG."default",
	USER_ID INTEGER NOT NULL,
	ROLE CHARACTER VARYING(50) COLLATE PG_CATALOG."default",
	CONSTRAINT "fk_reports_users" FOREIGN KEY (USER_ID) REFERENCES PUBLIC."users" (USER_ID) ON DELETE
	SET NULL
);
CREATE TABLE IF NOT EXISTS PUBLIC."reviews" (
	REVIEW_ID SERIAL PRIMARY KEY,
	RATING INTEGER,
	REVIEW_TEXT TEXT COLLATE PG_CATALOG."default",
	REVIEW_DATE DATE,
	EVENT_ID INTEGER,
	ACCOMMODATION_ID INTEGER,
	TOUR_ID INTEGER,
	STATUS CHARACTER VARYING(50) COLLATE PG_CATALOG."default",
	TOURIST_ID INTEGER NOT NULL,
	PACKAGE_ID INTEGER NOT NULL,
	CONSTRAINT "fk_reviews_events" FOREIGN KEY (EVENT_ID) REFERENCES PUBLIC."events" (EVENT_ID) ON DELETE
	SET NULL,
		CONSTRAINT "fk_reviews_accommodations" FOREIGN KEY (ACCOMMODATION_ID) REFERENCES PUBLIC."accommodations" (ACCOMMODATION_ID) ON DELETE
	SET NULL,
		CONSTRAINT "fk_reviews_tours" FOREIGN KEY (TOUR_ID) REFERENCES PUBLIC."tours" (TOUR_ID) ON DELETE
	SET NULL,
		CONSTRAINT "fk_reviews_tourists" FOREIGN KEY (TOURIST_ID) REFERENCES PUBLIC."tourists" (TOURIST_ID) ON DELETE
	SET NULL,
		CONSTRAINT "fk_reviews_packages" FOREIGN KEY (PACKAGE_ID) REFERENCES PUBLIC."packages" (PACKAGE_ID) ON DELETE
	SET NULL
);
CREATE TABLE IF NOT EXISTS PUBLIC."tours" (
	TOUR_ID SERIAL PRIMARY KEY,
	ACTIVITY CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
	PICTURE_URL TEXT COLLATE PG_CATALOG."default"
);
CREATE TABLE IF NOT EXISTS PUBLIC."tourists" (
	TOURIST_ID SERIAL PRIMARY KEY,
	FIRST_NAME CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
	LAST_NAME CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
	EMAIL_ADDRESS CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
	CONTACT_NUMBER CHARACTER VARYING(15) COLLATE PG_CATALOG."default",
	NIC_NUMBER CHARACTER VARYING(12) COLLATE PG_CATALOG."default",
	COUNTRY CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
	CITY CHARACTER VARYING(100) COLLATE PG_CATALOG."default",
	POSTAL_CODE CHARACTER VARYING(20) COLLATE PG_CATALOG."default",
	ADDRESSLINE_01 CHARACTER VARYING(255) COLLATE PG_CATALOG."default",
	ADDRESSLINE_02 CHARACTER VARYING(255) COLLATE PG_CATALOG."default"
);